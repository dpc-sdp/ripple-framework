{"_path":"/framework/guides/creating-new-layers","_dir":"guides","_draft":false,"_partial":false,"_locale":"","title":"Creating new layers","description":"Implementing custom functionality through layers","layout":"page","links":[{"text":"Nuxt layers documentation","url":"https://nuxt.com/docs/getting-started/layers"}],"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Nuxt layers are used to encapsulate Ripple functionality, so it can easily be shared and reused across projects, see "},{"type":"element","tag":"a","props":{"href":"/framework/key-concepts/nuxt-layers"},"children":[{"type":"text","value":"key concepts - layers"}]},{"type":"text","value":" for a conceptual overview of what layers are and how they are used within Ripple."}]},{"type":"element","tag":"h2","props":{"id":"creating-a-new-layer"},"children":[{"type":"text","value":"Creating a new layer"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The Nuxt Ripple CLI provides a simple way to initialise new layers, to create a new layer just run the following command:"}]},{"type":"element","tag":"pre","props":{"code":"npx @dpc-sdp/nuxt-ripple-cli init layer [DIRECTORY] --name {NAME}\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"npx @dpc-sdp/nuxt-ripple-cli init layer [DIRECTORY] --name {NAME}\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Where "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"[DIRECTORY]"}]},{"type":"text","value":" is the location to output the layer scaffolding and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"{NAME}"}]},{"type":"text","value":" is the name of the new layer. This command will scaffold everything you need to get started developing a new layer."}]},{"type":"element","tag":"h2","props":{"id":"developing-the-layer"},"children":[{"type":"text","value":"Developing the layer"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Once the layer has been created you can start working with it by running the command below from the new layers directory. This will start a development server and allow you to start working on the layer."}]},{"type":"element","tag":"pre","props":{"code":"npm run dev\n","language":"bash","meta":"","className":"language-bash shiki shiki-themes github-light","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":"npm"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":" run dev\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playground"}]},{"type":"text","value":" folder contains the essentials to get a test Nuxt application up and running, it includes a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"app.config.js"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxt.config.js"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".env"}]},{"type":"text","value":" file. The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxt.config.js"}]},{"type":"text","value":" includes a core set of layers used by Ripple to get a reference sdp site up and running, it also includes the new layer itself."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"playground"}]},{"type":"text","value":" folder is a fully functional Nuxt application and can be used to test the new layer in isolation."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The layers structure is almost identical to a normal Nuxt app, meaning you can utilise the same features and conventions as a standard Nuxt application. i.e. create a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pages"}]},{"type":"text","value":" folder for new pages, create a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"components"}]},{"type":"text","value":" folder for new components, etc."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Other useful commands:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"npm run build"}]},{"type":"text","value":" to do a production build of the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".preview"}]},{"type":"text","value":" application (for testing purposes)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"npm run lint"}]},{"type":"text","value":" to lint the layer code with "},{"type":"element","tag":"a","props":{"href":"https://eslint.org/","rel":["nofollow"]},"children":[{"type":"text","value":"eslint"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"npm run test"}]},{"type":"text","value":" to run any unit tests with "},{"type":"element","tag":"a","props":{"href":"https://jestjs.io/","rel":["nofollow"]},"children":[{"type":"text","value":"jest"}]}]}]},{"type":"element","tag":"h2","props":{"id":"publishing-the-layer"},"children":[{"type":"text","value":"Publishing the layer"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Once the layer is ready to be published it can be published to npm or pushed to a remote git repository, "},{"type":"element","tag":"a","props":{"href":"https://github.com/","rel":["nofollow"]},"children":[{"type":"text","value":"GitHub"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"https://about.gitlab.com/","rel":["nofollow"]},"children":[{"type":"text","value":"GitLab"}]},{"type":"text","value":", and "},{"type":"element","tag":"a","props":{"href":"https://bitbucket.org/","rel":["nofollow"]},"children":[{"type":"text","value":"Bitbucket"}]},{"type":"text","value":" are supported.\nFor more on publishing to npm see "},{"type":"element","tag":"a","props":{"href":"https://docs.npmjs.com/packages-and-modules/contributing-packages-to-the-registry","rel":["nofollow"]},"children":[{"type":"text","value":"contributing packages to the npm registry"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h2","props":{"id":"using-the-layer"},"children":[{"type":"text","value":"Using the layer"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Nuxt layers can be added to any Nuxt site by including the layer in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxt.config.js"}]},{"type":"text","value":" file under extends. If the layer is published to npm don't forget to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"npm install"}]},{"type":"text","value":" it first."}]},{"type":"element","tag":"pre","props":{"code":"export default defineNuxtConfig({\n  extends: [\n    '@dpc-sdp/nuxt-ripple', // An npm installed package\n    'github:dpc-sdp/ripple-vic-gov-au-custom#1.0.0' // A tagged git repository\n  ]\n})\n","language":"js","meta":"","className":"language-js shiki shiki-themes github-light","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49"},"children":[{"type":"text","value":"export"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49"},"children":[{"type":"text","value":" default"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":" defineNuxtConfig"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":"({\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":"  extends: [\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":"    '@dpc-sdp/nuxt-ripple'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":", "}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D"},"children":[{"type":"text","value":"// An npm installed package\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":"    'github:dpc-sdp/ripple-vic-gov-au-custom#1.0.0'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6A737D"},"children":[{"type":"text","value":" // A tagged git repository\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":"  ]\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":6},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":"})\n"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Also, make sure to check the layers documentation for any additional configuration that may be required."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To extend from a private repository, you need to add a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"GIGET_AUTH=<token>"}]},{"type":"text","value":" environment variable, with an auth token from your git provider."}]}]},{"type":"element","tag":"h3","props":{"id":"caveats-when-using-layers-from-a-git-repository"},"children":[{"type":"text","value":"Caveats when using layers from a git repository"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If a layer is added via a git repository and that layer has npm dependencies, you will need to manually install them within the Nuxt application utilising the layer. The Nuxt team are looking at auto-installing layer dependencies in the future, see "},{"type":"element","tag":"a","props":{"href":"https://github.com/nuxt/nuxt/issues/13367","rel":["nofollow"]},"children":[{"type":"text","value":"issue #13367"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You will also need to alias the dependencies in the Nuxt application, so they can be resolved to the correct package location. This can be done by adding an "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"alias"}]},{"type":"text","value":" object to the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxt.config.js"}]},{"type":"text","value":" file."}]},{"type":"element","tag":"pre","props":{"code":"export default defineNuxtConfig({\n  alias: {\n    'date-fns': require.resolve('date-fns')\n  }\n})\n","language":"js","meta":"","className":"language-js shiki shiki-themes github-light","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49"},"children":[{"type":"text","value":"export"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#D73A49"},"children":[{"type":"text","value":" default"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":" defineNuxtConfig"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":"({\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":"  alias: {\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":"    'date-fns'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":": require."}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#6F42C1"},"children":[{"type":"text","value":"resolve"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#032F62"},"children":[{"type":"text","value":"'date-fns'"}]},{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":")\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":"  }\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":5},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-default:#24292E"},"children":[{"type":"text","value":"})\n"}]}]}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"creating-a-new-layer","depth":2,"text":"Creating a new layer"},{"id":"developing-the-layer","depth":2,"text":"Developing the layer"},{"id":"publishing-the-layer","depth":2,"text":"Publishing the layer"},{"id":"using-the-layer","depth":2,"text":"Using the layer","children":[{"id":"caveats-when-using-layers-from-a-git-repository","depth":3,"text":"Caveats when using layers from a git repository"}]}]}},"_type":"markdown","_id":"content:framework:3.guides:5.creating-new-layers.md","_source":"content","_file":"framework/3.guides/5.creating-new-layers.md","_extension":"md"}